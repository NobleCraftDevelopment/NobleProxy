package ir.xenoncommunity.modules.impl;

import io.netty.buffer.ByteBuf;
import ir.xenoncommunity.annotations.ModuleListener;
import net.md_5.bungee.api.event.PacketReceiveEvent;
import net.md_5.bungee.api.plugin.Listener;
import net.md_5.bungee.event.EventHandler;

@ModuleListener(isExtended = false, isImplemented = true)
public class ExploitPatcher implements Listener {

    @EventHandler
    public void onPacketReceive(PacketReceiveEvent e) {
        final ByteBuf buf = e.getPacket().buf.duplicate();
        final byte[] packetData = new byte[buf.readableBytes()];
        buf.getBytes(0, packetData);

        if (packetData.length > 5000) {
            e.setCancelled(true);
            return;
        }
    }
}
